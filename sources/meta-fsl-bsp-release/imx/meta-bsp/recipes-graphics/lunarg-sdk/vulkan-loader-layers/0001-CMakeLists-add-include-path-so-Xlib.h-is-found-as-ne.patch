From 32f2777c9cc8f7dfc8b1e0c6894191167e76d5c4 Mon Sep 17 00:00:00 2001
From: Awais Belal <awais_belal@mentor.com>
Date: Tue, 16 Aug 2016 19:35:35 +0500
Subject: [PATCH] CMakeLists: add include path so Xlib.h is found as needed

All the targets including vk_platform.h or directly including
X11/Xlib.h require to know the directory for the installed
header. Add the directory to these so the requirements are
filled in properly.

Signed-off-by: Awais Belal <awais_belal@mentor.com>
---
 CMakeLists.txt             | 2 ++
 demos/CMakeLists.txt       | 2 +-
 layers/CMakeLists.txt      | 1 +
 libs/vkjson/CMakeLists.txt | 1 +
 loader/CMakeLists.txt      | 1 +
 5 files changed, 6 insertions(+), 1 deletion(-)

Index: git/CMakeLists.txt
===================================================================
--- git.orig/CMakeLists.txt	2017-02-22 13:43:46.415277554 -0600
+++ git/CMakeLists.txt	2017-02-22 13:43:46.411277534 -0600
@@ -175,6 +175,8 @@
                                                    "${EXTERNAL_SOURCE_ROOT}/source/spirv-tools/external/include"
                                              DOC "Path to spirv-tools/libspirv.h")
 
+find_path(X11_XLIB_INCLUDE_DIR X11/Xlib.h DOC "Path to X11/Xlib.h")
+
 find_library(GLSLANG_LIB NAMES glslang
              HINTS ${GLSLANG_SEARCH_PATH} )
 
Index: git/demos/CMakeLists.txt
===================================================================
--- git.orig/demos/CMakeLists.txt	2017-02-22 13:43:46.415277554 -0600
+++ git/demos/CMakeLists.txt	2017-02-22 13:52:48.000000000 -0600
@@ -19,7 +19,7 @@
         if (NOT BUILD_WSI_XLIB_SUPPORT)
             message( FATAL_ERROR "Selected XLIB for demos build but not building Xlib support" )
         endif()
-        include_directories(${X11_INCLUDE_DIR})
+        include_directories(${X11_INCLUDE_DIR} ${X11_XLIB_INCLUDE_DIR})
         link_libraries(${X11_LIBRARIES})
         add_definitions(-DVK_USE_PLATFORM_XLIB_KHR)
     elseif(DEMOS_WSI_SELECTION STREQUAL "WAYLAND")
Index: git/layers/CMakeLists.txt
===================================================================
--- git.orig/layers/CMakeLists.txt	2017-02-22 13:43:46.415277554 -0600
+++ git/layers/CMakeLists.txt	2017-02-22 13:43:46.411277534 -0600
@@ -121,6 +121,7 @@
     ${CMAKE_CURRENT_SOURCE_DIR}/../loader
     ${CMAKE_CURRENT_SOURCE_DIR}/../include/vulkan
     ${CMAKE_CURRENT_BINARY_DIR}
+    ${X11_XLIB_INCLUDE_DIR}
 )
 
 if (WIN32)
Index: git/libs/vkjson/CMakeLists.txt
===================================================================
--- git.orig/libs/vkjson/CMakeLists.txt	2017-02-22 13:43:46.415277554 -0600
+++ git/libs/vkjson/CMakeLists.txt	2017-02-22 13:43:46.411277534 -0600
@@ -23,6 +23,7 @@
 	${CMAKE_CURRENT_SOURCE_DIR}
 	${CMAKE_CURRENT_SOURCE_DIR}/../../loader
 	${CMAKE_CURRENT_SOURCE_DIR}/../../include/vulkan
+	${X11_XLIB_INCLUDE_DIR}
 	)
 
 add_library(vkjson STATIC vkjson.cc vkjson_instance.cc ../../loader/cJSON.c)
Index: git/loader/CMakeLists.txt
===================================================================
--- git.orig/loader/CMakeLists.txt	2017-02-22 13:43:46.415277554 -0600
+++ git/loader/CMakeLists.txt	2017-02-22 13:43:46.411277534 -0600
@@ -1,6 +1,7 @@
 include_directories(
 	${CMAKE_CURRENT_SOURCE_DIR}
 	${CMAKE_CURRENT_BINARY_DIR}
+	${X11_XLIB_INCLUDE_DIR}
 )
 if(CMAKE_SYSTEM_NAME STREQUAL "Windows")
     add_definitions(-DVK_USE_PLATFORM_WIN32_KHR -DWIN32_LEAN_AND_MEAN)
